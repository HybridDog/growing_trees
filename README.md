TODO:
* remove and localize generic functions
